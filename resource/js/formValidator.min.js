(function(e){e.formValidator={initConfig:function(a){var c={debug:!1,validatorGroup:"1",alertMessage:!1,validObjects:[],ajaxObjects:"",forceValid:!1,onSuccess:function(){return!0},onError:e.noop,submitOnce:!1,formID:"",submitButtonID:"",autoTip:!1,tidyMode:!1,errorFocus:!0,wideWord:!0,status:"",submitAfterAjaxPrompt:"\u5f53\u524d\u6709\u6570\u636e\u6b63\u5728\u8fdb\u884c\u670d\u52a1\u5668\u7aef\u6821\u9a8c\uff0c\u8bf7\u7a0d\u5019",validCount:0,ajaxCountSubmit:0,ajaxCountValid:0,inIframe:!1};a=a||
{};e.extend(c,a);c.tidyMode&&(c.errorFocus=!1);""!=c.formID?e("#"+c.formID).submit(function(){return e.formValidator.bindSubmit(c)}):""!=c.submitButtonID&&e("#"+c.submitButtonID).click(function(){return e.formValidator.bindSubmit(c)});e("body").data(c.validatorGroup,c)},bindSubmit:function(a){return 0<a.ajaxCountValid&&""!=a.submitAfterAjaxPrompt?(alert(a.submitAfterAjaxPrompt),!1):e.formValidator.pageIsValid(a.validatorGroup)},sustainType:function(a,c){var d=e("#"+a).get(0),f=d.tagName,d=d.type;
switch(c.validateType){case "InitValidator":return!0;case "InputValidator":return"INPUT"==f||"TEXTAREA"==f||"SELECT"==f;case "CompareValidator":return"INPUT"==f||"TEXTAREA"==f?"checkbox"!=d&&"radio"!=d:!1;case "AjaxValidator":return"text"==d||"textarea"==d||"file"==d||"password"==d||"select-one"==d;case "RegexValidator":return"INPUT"==f||"TEXTAREA"==f?"checkbox"!=d&&"radio"!=d:!1;case "FunctionValidator":return!0}},appendValid:function(a,c){if(!e.formValidator.sustainType(a,c))return-1;var d=e("#"+
a).get(0);if("InitValidator"==c.validateType||void 0==d.settings)d.settings=[];var f=d.settings.push(c);d.settings[f-1].index=f-1;return f-1},setTipState:function(a,c,d){var f=e("body").data(a.validatorGroup),h=e("#"+a.settings[0].tipID);null==d||""==d?h.hide():f.tidyMode?(e("#fv_content").html(d),a.Tooltip=d,"onError"!=c&&h.hide()):h.show().removeClass().addClass(c).html(d)},resetTipState:function(a){void 0==a&&(a="1");a=e("body").data(a);e.each(a.validObjects,function(){var a=this.get(0),d=a.settings[0],
f=d.defaultPassed;e.formValidator.setTipState(a,f?"onCorrect":"onShow",f?d.onCorrect:d.onShow)})},setFailState:function(a,c){e("#"+a).removeClass().addClass("onError").html(c)},showMessage:function(a){var c=a.id,d=e("#"+c).get(0),f=a.isValid,h=a.setting,g="",k="",m=e("body").data(d.validatorGroup);f?(g=e.formValidator.isEmpty(c)?h.onEmpty:h.onCorrect,e.formValidator.setTipState(d,"onCorrect",g)):(k="onError","AjaxValidator"==h.validateType?""==h.lastValid?(k="onLoad",g=h.onWait):g=h.onError:g=""==
a.errormsg?h.onError:a.errormsg,m.alertMessage?d.validValueOld!=e(d).val()&&alert(g):e.formValidator.setTipState(d,k,g));return g},showAjaxMessage:function(a){var c=e("#"+a.id).get(0),d=c.settings[a.ajax],f=c.validValueOld,h=e(c).val();a.setting=d;f!=h||f==h&&!c.onceValided?e.formValidator.ajaxValid(a):(void 0!=d.isValid&&!d.isValid&&(c.lastshowclass="onError",c.lastshowmsg=d.onError),e.formValidator.setTipState(c,c.lastshowclass,c.lastshowmsg))},getLength:function(a){var c=e("#"+a),d=c.get(0),f=
d.type;a=0;switch(f){case "text":case "hidden":case "password":case "textarea":case "file":c=c.val();if(e("body").data(d.validatorGroup).wideWord)for(d=0;d<c.length;d++)a+=19968<=c.charCodeAt(d)&&40869>=c.charCodeAt(d)?2:1;else a=c.length;break;case "checkbox":case "radio":a=e("input[type='"+f+"'][name='"+c.attr("name")+"']:checked").length;break;case "select-one":a=d.options?d.options.selectedIndex:-1;break;case "select-multiple":a=e("select[name="+d.name+"] option:selected").length}return a},isEmpty:function(a){return e("#"+
a).get(0).settings[0].empty&&0==e.formValidator.getLength(a)},isOneValid:function(a){return e.formValidator.oneIsValid(a).isValid},oneIsValid:function(a){var c={},d=e("#"+a).get(0);c.initConfig=e("body").data(d.validatorGroup);c.id=a;c.ajax=-1;c.errormsg="";var f=d.settings,h=f.length,g;1==h&&(f[0].bind=!1);if(!f[0].bind)return null;for(var k=0;k<h;k++)if(0==k){if(e.formValidator.isEmpty(a)){c.isValid=!0;c.setting=f[0];break}}else{c.setting=f[k];g=f[k].validateType;switch(g){case "InputValidator":e.formValidator.inputValid(c);
break;case "CompareValidator":e.formValidator.compareValid(c);break;case "RegexValidator":e.formValidator.regexValid(c);break;case "FunctionValidator":e.formValidator.functionValid(c);break;case "AjaxValidator":c.ajax=k}d.onceValided=!0;if(f[k].isValid){if(c.isValid=!0,c.setting=f[0],"AjaxValidator"==f[k].validateType)break}else{c.isValid=!1;c.setting=f[k];break}}return c},pageIsValid:function(a){void 0==a&&(a="1");var c=!0,d,f="",h,g="^",k,m,n="^",p=[],l=e("body").data(a);l.status="sumbiting";l.ajaxCountSubmit=
0;e.each(l.validObjects,function(){this.settings[0].bind&&(void 0!=this.validatorAjaxIndex&&void 0==this.onceValided)&&(d=e.formValidator.oneIsValid(this.id),d.ajax==this.validatorAjaxIndex&&(l.status="sumbitingWithAjax",e.formValidator.ajaxValid(d)))});if(0<l.ajaxCountSubmit)return!1;e.each(l.validObjects,function(){if(this.settings[0].bind&&(m=this.name,-1==n.indexOf("^"+m+"^")&&(onceValided=void 0==this.onceValided?!1:this.onceValided,m&&(n=n+m+"^"),d=e.formValidator.oneIsValid(this.id))))if(d.isValid||
(c=!1,h=""==d.errormsg?d.setting.onError:d.errormsg,p[p.length]=h,null==k&&(k=d.id),""==f&&(f=h)),!l.alertMessage){var a=this.settings[0].tipID;-1==g.indexOf("^"+a+"^")&&(d.isValid||(g=g+a+"^"),e.formValidator.showMessage(d))}});if(c){if(!l.onSuccess())return!1;l.submitOnce&&e(":submit,:button,:reset").attr("disabled",!0)}else l.onError(f,e("#"+k).get(0),p),k&&l.errorFocus&&e("#"+k).focus();l.status="init";return!l.debug&&c},ajaxValid:function(a){var c=a.id,d=e("#"+c).get(0),f=a.initConfig,h=d.settings,
g=h[a.ajax],k=g.url,m=d.validatorGroup,f=e("body").data(m),n=e(f.ajaxObjects).serialize(),n="clientid="+c+"&"+(g.randNumberName?g.randNumberName+"="+((new Date).getTime()+Math.round(1E4*Math.random())):"")+(0<n.length?"&"+n:""),k=k+(-1<k.indexOf("?")?"&"+n:"?"+n);e.ajax({type:g.type,url:k,cache:g.cache,data:g.data,async:g.async,timeout:g.timeout,dataType:g.dataType,success:function(c,k,q){e.formValidator.dealAjaxRequestCount(m,-1);c=g.success(c,k,q);(g.isValid=c)?(c="onCorrect",k=h[0].onCorrect):
(c="onError",k=g.onError);e.formValidator.setTipState(d,c,k);"sumbitingWithAjax"==a.initConfig.status&&0==a.initConfig.ajaxCountSubmit&&(""!=f.formID?e("#"+f.formID).trigger("submit"):""!=f.formID&&e("#"+f.submitButtonID).trigger("click"))},complete:function(a,d){g.buttons&&0<g.buttons.length&&g.buttons.attr({disabled:!1});g.complete(a,d)},beforeSend:function(c,f){this.lastXMLHttpRequest&&this.lastXMLHttpRequest.abort();this.lastXMLHttpRequest=c;g.buttons&&0<g.buttons.length&&g.buttons.attr({disabled:!0});
var k=g.beforeSend(c,f);k&&(g.isValid=!1,e.formValidator.setTipState(d,"onLoad",h[a.ajax].onWait));g.lastValid="-1";k&&e.formValidator.dealAjaxRequestCount(m,1);return k},error:function(a,c,f){e.formValidator.dealAjaxRequestCount(m,-1);e.formValidator.setTipState(d,"onError",g.onError);g.isValid=!1;g.error(a,c,f)},processData:g.processData})},dealAjaxRequestCount:function(a,c){var d=e("body").data(a);d.ajaxCountValid+=c;"sumbitingWithAjax"==d.status&&(d.ajaxCountSubmit+=c)},regexValid:function(a){var c=
a.id,d=a.setting;e("#"+c).get(0);var f=e("#"+c).get(0),h;f.settings[0].empty&&""==f.value?d.isValid=!0:(a=d.regExp,d.isValid=!1,"string"==typeof a&&(a=[a]),e.each(a,function(){var a=this;"enum"==d.dataType&&(a=eval("regexEnum."+a));if(void 0==a||""==a)return!1;h=RegExp(a,d.param).test(e(f).val());if("||"==d.compareType&&h)return d.isValid=!0,!1;if("&&"==d.compareType&&!h)return!1}),d.isValid||(d.isValid=h))},functionValid:function(a){var c=a.setting,d=e("#"+a.id),d=c.fun(d.val(),d.get(0));void 0!=
d&&("string"===typeof d?(c.isValid=!1,a.errormsg=d):c.isValid=d)},inputValid:function(a){var c=a.id,d=a.setting,f=e("#"+c),h=f.get(0),f=f.val(),h=h.type,c=e.formValidator.getLength(c),g=d.empty,k=!1;switch(h){case "text":case "hidden":case "password":case "textarea":case "file":"size"==d.type&&(g=d.empty,g.leftEmpty||(k=f.replace(/^[ \s]+/,"").length!=f.length),!k&&!g.rightEmpty&&(k=f.replace(/[ \s]+$/,"").length!=f.length),k&&g.emptyError&&(a.errormsg=g.emptyError));case "checkbox":case "select-one":case "select-multiple":case "radio":g=
!1;if("select-one"==h||"select-multiple"==h)d.type="size";h=d.type;"size"==h?(k||(g=!0),g&&(f=c)):"date"==h||"datetime"==h?("date"==h&&(g=isDate(f)),"datetime"==h&&(g=isDate(f)),g&&(f=new Date(f),d.min=new Date(d.min),d.max=new Date(d.max))):(stype=typeof d.min,"number"==stype&&(f=(new Number(f)).valueOf(),isNaN(f)||(g=!0)),"string"==stype&&(g=!0));d.isValid=!1;g&&(f<d.min||f>d.max?(f<d.min&&d.onErrorMin&&(a.errormsg=d.onErrorMin),f>d.min&&d.onErrorMax&&(a.errormsg=d.onErrorMax)):d.isValid=!0)}},
compareValid:function(a){var c=a.setting,d=e("#"+a.id),f=e("#"+c.desID);a=c.dataType;curvalue=d.val();ls_data=f.val();if("number"==a)if(!isNaN(curvalue)&&!isNaN(ls_data))curvalue=parseFloat(curvalue),ls_data=parseFloat(ls_data);else return;if("date"==a||"datetime"==a)if(d=!1,"date"==a&&(d=isDate(curvalue)&&isDate(ls_data)),"datetime"==a&&(d=isDateTime(curvalue)&&isDateTime(ls_data)),d)curvalue=new Date(curvalue),ls_data=new Date(ls_data);else return;switch(c.operateor){case "=":c.isValid=curvalue==
ls_data;break;case "!=":c.isValid=curvalue!=ls_data;break;case ">":c.isValid=curvalue>ls_data;break;case ">=":c.isValid=curvalue>=ls_data;break;case "<":c.isValid=curvalue<ls_data;break;case "<=":c.isValid=curvalue<=ls_data;break;default:c.isValid=!1}},localTooltip:function(a){a=a||window.event;var c=a.pageX||(a.clientX?a.clientX+document.body.scrollLeft:0);a=a.pageY||(a.clientY?a.clientY+document.body.scrollTop:0);e("#fvtt").css({top:a+2+"px",left:c-40+"px"})},reloadAutoTip:function(a){void 0==a&&
(a="1");var c=e("body").data(a);e.each(c.validObjects,function(){if(c.autoTip&&!c.tidyMode){var a=this.settings[0],f="#"+a.relativeID,h=e(f).offset(),g=h.top,f=e(f).width()+h.left;e("#"+a.tipID).parent().show().css({left:f+"px",top:g+"px"})}})}};e.fn.formValidator=function(a){var c={validatorGroup:"1",empty:!1,autoModify:!1,onShow:"\u8bf7\u8f93\u5165\u5185\u5bb9",onFocus:"\u8bf7\u8f93\u5165\u5185\u5bb9",onCorrect:"\u8f93\u5165\u6b63\u786e",onEmpty:"\u8f93\u5165\u5185\u5bb9\u4e3a\u7a7a",defaultValue:null,
bind:!0,ajax:!1,validateType:"InitValidator",tipCss:{left:"10px",top:"1px",height:"20px",width:"250px"},triggerEvent:"blur",forceValid:!1,tipID:null,relativeID:null,index:0};a=a||{};void 0==a.validatorGroup&&(a.validatorGroup="1");var d=e("body").data(a.validatorGroup);d.validCount+=1;d.tidyMode&&(c.tipCss={left:"2px",width:"22px",height:"22px",display:"none"});d.alertMessage&&(c.autoModify=!0);e.extend(!0,c,a);return this.each(function(f){this.validatorIndex=d.validCount-1;this.validatorGroup=a.validatorGroup;
var h=e(this);f={};e.extend(!0,f,c);var g=f.tipID?f.tipID:this.id+"Tip";if(d.autoTip)if(d.tidyMode)h.showTooltips();else if(0==e("body [id="+g+"]").length){var k=f.relativeID?f.relativeID:this.id,m=e("#"+k).position(),n=m.top,m=e("#"+k).width()+m.left,p=e("<div class='formValidateTip'></div>");d.inIframe&&p.hide();p.appendTo(e("body")).css({left:m+"px",top:n+"px"}).prepend(e('<div id="'+g+'"></div>').css(f.tipCss));c.relativeID=k}c.tipID=g;e.formValidator.appendValid(this.id,c);-1==e.inArray(h,d.validObjects)&&
(f.ajax&&(f=d.ajaxObjects,d.ajaxObjects=f+(""!=f?",#":"#")+this.id),d.validObjects.push(this));d.alertMessage||e.formValidator.setTipState(this,"onShow",c.onShow);f=this.tagName.toLowerCase();var l=this.type;(k=c.defaultValue)&&h.val(k);"input"==f||"textarea"==f?(h.focus(function(){if(!d.alertMessage){var a=e("#"+g);this.lastshowclass=a.attr("class");this.lastshowmsg=a.html();e.formValidator.setTipState(this,"onFocus",c.onFocus)}if("password"==l||"text"==l||"textarea"==l||"file"==l)this.validValueOld=
h.val()}),h.bind(c.triggerEvent,function(){var a=e.formValidator.oneIsValid(this.id);if(null!=a)if(0<=a.ajax)e.formValidator.showAjaxMessage(a);else{var f=e.formValidator.showMessage(a);if(!a.isValid)if(c.autoModify&&("text"==this.type||"textarea"==this.type||"file"==this.type))e(this).val(this.validValueOld),d.alertMessage||e.formValidator.setTipState(this,"onShow",c.onShow);else if(d.forceValid||c.forceValid)alert(f),this.focus()}})):"select"==f&&h.bind({focus:function(){d.alertMessage||e.formValidator.setTipState(this,
"onFocus",c.onFocus)},blur:function(){e(this).trigger("change")},change:function(){var a=e.formValidator.oneIsValid(this.id);null!=a&&(0<=a.ajax?e.formValidator.showAjaxMessage(a):e.formValidator.showMessage(a))}})})};e.fn.inputValidator=function(a){var c={isValid:!1,min:0,max:99999999999999,type:"size",onError:"\u8f93\u5165\u9519\u8bef",validateType:"InputValidator",empty:{leftEmpty:!0,rightEmpty:!0,leftEmptyError:null,rightEmptyError:null}};a=a||{};e.extend(!0,c,a);return this.each(function(){e.formValidator.appendValid(this.id,
c)})};e.fn.compareValidator=function(a){var c={isValid:!1,desID:"",operateor:"=",onError:"\u8f93\u5165\u9519\u8bef",validateType:"CompareValidator"};a=a||{};e.extend(!0,c,a);return this.each(function(){e.formValidator.appendValid(this.id,c)})};e.fn.regexValidator=function(a){var c={isValid:!1,regExp:"",param:"i",dataType:"string",compareType:"||",onError:"\u8f93\u5165\u7684\u683c\u5f0f\u4e0d\u6b63\u786e",validateType:"RegexValidator"};a=a||{};e.extend(!0,c,a);return this.each(function(){e.formValidator.appendValid(this.id,
c)})};e.fn.functionValidator=function(a){var c={isValid:!0,fun:function(){this.isValid=!0},validateType:"FunctionValidator",onError:"\u8f93\u5165\u9519\u8bef"};a=a||{};e.extend(!0,c,a);return this.each(function(){e.formValidator.appendValid(this.id,c)})};e.fn.ajaxValidator=function(a){var c={type:"GET",url:"",dataType:"html",timeout:1E5,data:null,async:!0,cache:!1,beforeSend:function(){return!0},success:function(){return!0},complete:function(){},processData:!0,error:function(){},isValid:!1,lastValid:"",
buttons:null,oneceValid:!1,randNumberName:"rand",onError:"\u670d\u52a1\u5668\u6821\u9a8c\u6ca1\u6709\u901a\u8fc7",onWait:"\u6b63\u5728\u7b49\u5f85\u670d\u52a1\u5668\u8fd4\u56de\u6570\u636e",ajaxExistsError:"\u524d\u9762\u7684\u6821\u9a8c\u5c1a\u672a\u5b8c\u6210\uff0c\u8bf7\u7a0d\u5019...",validateType:"AjaxValidator"};a=a||{};e.extend(!0,c,a);return this.each(function(){var a=e("body").data(this.validatorGroup),f=a.ajaxObjects;-1==(f+",").indexOf("#"+this.id+",")&&(a.ajaxObjects=f+(""!=f?",#":"#")+
this.id);this.validatorAjaxIndex=e.formValidator.appendValid(this.id,c)})};e.fn.defaultPassed=function(a){return this.each(function(){var c=this.settings;c[0].defaultPassed=!0;for(var d=1;d<c.length;d++)c[d].isValid=!0,e("body").data(c[0].validatorGroup).alertMessage||e.formValidator.setTipState(this,a?"onShow":"onCorrect",c[0].onCorrect)})};e.fn.unFormValidator=function(a){return this.each(function(){this.settings[0].bind=!a;a?e("#"+this.settings[0].tipID).hide():e("#"+this.settings[0].tipID).show()})};
e.fn.showTooltips=function(){0==e("body [id=fvtt]").length&&(fvtt=e("<div id='fvtt' style='position:absolute;z-index:56002'></div>"),e("body").append(fvtt),fvtt.before("<iframe src='about:blank' class='fv_iframe' scrolling='no' frameborder='0'></iframe>"));return this.each(function(){jqobj=e(this);s=e("<span class='top' id=fv_content style='display:block'></span>");b=e("<b class='bottom' style='display:block' />");this.tooltip=e("<span class='fv_tooltip' style='display:block'></span>").append(s).append(b).css({filter:"alpha(opacity:95)",
KHTMLOpacity:"0.95",MozOpacity:"0.95",opacity:"0.95"});jqobj.bind({mouseover:function(a){e("#fvtt").append(this.tooltip);e("#fv_content").html(this.Tooltip);e.formValidator.localTooltip(a)},mouseout:function(){e("#fvtt").empty()},mousemove:function(a){e("#fv_content").html(this.Tooltip);e.formValidator.localTooltip(a)}})})}})(jQuery);
